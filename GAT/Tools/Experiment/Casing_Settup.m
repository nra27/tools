function Casing_Settup;
%
% Casing_Settup
%
% A function to create a picture of the casing

% Load Blade_Profiles
NGV = NGV_Profile;
HPB = HPB_Profile;

% Setup gauge locations
for j = 1:7
    gauge_x(:,j) = linspace(20,-79,8)'/100*24.35;
end
for j = 1:8
    gauge_y(j,:) = linspace(0,-100,7)/100*272*2*pi/36-272*2*pi/36/48*(j-1);
end
    
% Delta NGV
D_NGV = 272*2*pi/36;
% Delta HPB
D_HPB = 272*2*pi/60*0.98;
% Delta HPB due to time
T_HPB = 6/144*272*2*pi/360*0.98;

axis off
axis equal
a = gca;
hold on

time = 0;

% Plot NGVs
plot(NGV(:,2)+D_NGV,NGV(:,1),'k')
plot(NGV(:,2),NGV(:,1),'k')
plot(NGV(:,2)-D_NGV,NGV(:,1),'k')
plot(NGV(:,2)-2*D_NGV,NGV(:,1),'k')

der = 1;

% Plot HPBs
plot(HPB(:,2)+der+D_HPB+(time-1)*T_HPB,HPB(:,1),'k')
plot(HPB(:,2)+der+(time-1)*T_HPB,HPB(:,1),'k')
plot(HPB(:,2)+der-D_HPB+(time-1)*T_HPB,HPB(:,1),'k')
plot(HPB(:,2)+der-2*D_HPB+(time-1)*T_HPB,HPB(:,1),'k')
plot(HPB(:,2)+der-3*D_HPB+(time-1)*T_HPB,HPB(:,1),'k')
plot(HPB(:,2)+der-4*D_HPB+(time-1)*T_HPB,HPB(:,1),'k')
plot(HPB(:,2)+der-5*D_HPB+(time-1)*T_HPB,HPB(:,1),'k')

% Plot the gauge points
plot(gauge_y,gauge_x,'k+')
    
% ----------------------------------------- end of Main routine ---------------------------------------------------
% NGV subroutine
function NGV = NGV_Profile;

NGV = [40.222   272.752    -0.994;
    40.217   272.753    -0.938;
    40.206   272.753    -0.865;
    40.191   272.753    -0.766;
    40.176   272.753    -0.672;
    40.160   272.754    -0.581;
    40.129   272.754    -0.405;
    40.098   272.754    -0.231;
    40.067   272.754    -0.051;
    40.036   272.754     0.133;
    40.006   272.754     0.318;
    39.975   272.754     0.503;
    39.944   272.753     0.687;
    39.913   272.753     0.869;
    39.604   272.741     2.686;
    39.295   272.717     4.506;
    38.986   272.681     6.325;
    38.676   272.633     8.138;
    38.367   272.573     9.939;
    38.058   272.502    11.715;
    37.749   272.422    13.455;
    37.440   272.333    15.148;
    37.131   272.237    16.783;
    36.822   272.136    18.355;
    36.513   272.030    19.865;
    36.204   271.920    21.314;
    35.895   271.808    22.700;
    35.585   271.694    24.024;
    35.276   271.579    25.293;
    34.967   271.462    26.517;
    34.658   271.343    27.705;
    34.349   271.223    28.864;
    34.040   271.099    30.003;
    33.731   270.972    31.126;
    33.422   270.842    32.239;
    33.113   270.709    33.342;
    32.804   270.572    34.430;
    32.495   270.434    35.498;
    32.185   270.295    36.541;
    31.876   270.156    37.555;
    31.567   270.019    38.532;
    31.258   269.884    39.467;
    30.949   269.752    40.357;
    30.640   269.624    41.203;
    30.331   269.501    42.004;
    30.022   269.382    42.759;
    29.713   269.268    43.471;
    29.404   269.159    44.139;
    29.094   269.055    44.767;
    28.785   268.957    45.355;
    28.476   268.864    45.904;
    28.167   268.776    46.415;
    27.858   268.693    46.893;
    27.549   268.615    47.337;
    27.240   268.542    47.752;
    26.931   268.472    48.141;
    26.622   268.407    48.504;
    26.313   268.345    48.846;
    26.004   268.286    49.168;
    25.694   268.230    49.471;
    25.385   268.178    49.757;
    25.076   268.128    50.025;
    24.767   268.081    50.275;
    24.458   268.037    50.507;
    24.149   267.997    50.722;
    23.840   267.959    50.920;
    23.531   267.925    51.100;
    23.222   267.894    51.264;
    22.913   267.866    51.411;
    22.603   267.841    51.541;
    22.294   267.819    51.654;
    21.985   267.800    51.750;
    21.676   267.785    51.829;
    21.367   267.773    51.891;
    21.058   267.764    51.937;
    20.749   267.758    51.968;
    20.440   267.755    51.986;
    20.131   267.754    51.990;
    19.822   267.755    51.983;
    19.512   267.759    51.964;
    19.203   267.765    51.933;
    18.894   267.773    51.891;
    18.585   267.783    51.839;
    18.276   267.795    51.775;
    17.967   267.810    51.701;
    17.658   267.826    51.616;
    17.349   267.845    51.520;
    17.040   267.865    51.413;
    16.731   267.888    51.294;
    16.422   267.913    51.163;
    16.112   267.941    51.018;
    15.803   267.971    50.859;
    15.494   268.004    50.685;
    15.185   268.039    50.496;
    14.876   268.078    50.292;
    14.567   268.118    50.075;
    14.258   268.161    49.844;
    13.949   268.206    49.602;
    13.640   268.253    49.347;
    13.331   268.302    49.083;
    13.021   268.352    48.809;
    12.712   268.402    48.529;
    12.403   268.454    48.240;
    12.094   268.508    47.942;
    11.785   268.563    47.634;
    11.476   268.619    47.315;
    11.167   268.678    46.981;
    10.858   268.741    46.619;
    10.549   268.808    46.226;
    10.240   268.880    45.806;
     9.931   268.955    45.363;
     9.621   269.035    44.889;
     9.591   269.045    44.830;
     9.560   269.055    44.767;
     9.529   269.066    44.700;
     9.498   269.078    44.627;
     9.467   269.092    44.547;
     9.436   269.106    44.457;
     9.405   269.123    44.354;
     9.374   269.144    44.231;
     9.359   269.156    44.157;
     9.343   269.170    44.069;
     9.328   269.189    43.954;
     9.317   269.210    43.828;
     9.312   269.235    43.674;
     9.317   269.260    43.518;
     9.328   269.280    43.391;
     9.343   269.298    43.278;
     9.359   269.313    43.190;
     9.374   269.324    43.116;
     9.405   269.344    42.993;
     9.436   269.361    42.890;
     9.467   269.375    42.800;
     9.498   269.388    42.720;
     9.529   269.399    42.647;
     9.560   269.410    42.579;
     9.591   269.420    42.516;
     9.621   269.429    42.458;
     9.652   269.438    42.402;
     9.683   269.446    42.350;
     9.714   269.454    42.300;
     9.745   269.461    42.253;
     9.776   269.468    42.208;
     9.807   269.475    42.165;
     9.838   269.482    42.123;
     9.869   269.488    42.084;
     9.900   269.494    42.046;
     9.931   269.500    42.009;
     9.961   269.505    41.973;
     9.992   269.510    41.939;
    10.023   269.515    41.906;
    10.054   269.520    41.875;
    10.085   269.525    41.844;
    10.116   269.530    41.814;
    10.147   269.534    41.785;
    10.178   269.539    41.757;
    10.209   269.543    41.730;
    10.240   269.547    41.704;
    10.271   269.551    41.679;
    10.301   269.555    41.654;
    10.332   269.558    41.630;
    10.363   269.562    41.607;
    10.394   269.565    41.585;
    10.425   269.569    41.563;
    10.456   269.572    41.542;
    10.487   269.575    41.520;
    10.518   269.579    41.499;
    10.549   269.582    41.478;
    10.580   269.585    41.457;
    10.611   269.588    41.436;
    10.641   269.591    41.415;
    10.672   269.595    41.394;
    10.703   269.598    41.374;
    10.734   269.601    41.353;
    10.765   269.604    41.333;
    10.796   269.607    41.312;
    10.827   269.610    41.291;
    10.858   269.614    41.271;
    11.167   269.646    41.060;
    11.476   269.678    40.848;
    11.785   269.710    40.635;
    12.094   269.742    40.422;
    12.403   269.774    40.208;
    12.712   269.806    39.994;
    13.021   269.838    39.778;
    13.331   269.870    39.561;
    13.640   269.902    39.342;
    13.949   269.934    39.122;
    14.258   269.966    38.899;
    14.567   269.999    38.675;
    14.876   270.031    38.449;
    15.185   270.063    38.220;
    15.494   270.096    37.991;
    15.803   270.128    37.759;
    16.112   270.161    37.526;
    16.422   270.193    37.291;
    16.731   270.226    37.054;
    17.040   270.259    36.815;
    17.349   270.291    36.575;
    17.658   270.324    36.333;
    17.967   270.357    36.089;
    18.276   270.389    35.843;
    18.585   270.422    35.595;
    18.894   270.455    35.345;
    19.203   270.488    35.093;
    19.512   270.521    34.838;
    19.822   270.554    34.580;
    20.131   270.587    34.320;
    20.440   270.620    34.056;
    20.749   270.654    33.789;
    21.058   270.687    33.519;
    21.367   270.721    33.245;
    21.676   270.755    32.968;
    21.985   270.789    32.687;
    22.294   270.823    32.403;
    22.603   270.857    32.115;
    22.913   270.892    31.823;
    23.222   270.926    31.527;
    23.531   270.961    31.228;
    23.840   270.996    30.925;
    24.149   271.031    30.618;
    24.458   271.066    30.306;
    24.767   271.101    29.989;
    25.076   271.136    29.667;
    25.385   271.172    29.339;
    25.694   271.208    29.005;
    26.004   271.244    28.665;
    26.313   271.280    28.319;
    26.622   271.317    27.966;
    26.931   271.354    27.606;
    27.240   271.391    27.239;
    27.549   271.428    26.864;
    27.858   271.466    26.483;
    28.167   271.503    26.093;
    28.476   271.541    25.695;
    28.785   271.580    25.288;
    29.094   271.618    24.872;
    29.404   271.657    24.446;
    29.713   271.695    24.010;
    30.022   271.735    23.562;
    30.331   271.774    23.103;
    30.640   271.814    22.632;
    30.949   271.854    22.147;
    31.258   271.894    21.649;
    31.567   271.934    21.137;
    31.876   271.974    20.610;
    32.185   272.015    20.067;
    32.495   272.056    19.507;
    32.804   272.097    18.929;
    33.113   272.137    18.331;
    33.422   272.178    17.712;
    33.731   272.219    17.071;
    34.040   272.260    16.406;
    34.349   272.301    15.715;
    34.658   272.342    14.997;
    34.967   272.382    14.248;
    35.276   272.421    13.468;
    35.585   272.460    12.655;
    35.895   272.499    11.806;
    36.204   272.536    10.919;
    36.513   272.571     9.994;
    36.822   272.605     9.030;
    37.131   272.636     8.029;
    37.440   272.665     6.991;
    37.749   272.690     5.918;
    38.058   272.712     4.811;
    38.367   272.729     3.669;
    38.676   272.743     2.494;
    38.986   272.751     1.288;
    39.295   272.754     0.052;
    39.326   272.754    -0.072;
    39.356   272.754    -0.195;
    39.387   272.754    -0.320;
    39.418   272.754    -0.446;
    39.449   272.754    -0.576;
    39.480   272.753    -0.709;
    39.511   272.753    -0.842;
    39.542   272.752    -0.968;
    39.573   272.752    -1.081;
    39.604   272.752    -1.156;
    39.635   272.752    -1.202;
    39.666   272.751    -1.235;
    39.696   272.751    -1.261;
    39.727   272.751    -1.281;
    39.758   272.751    -1.296;
    39.789   272.751    -1.308;
    39.820   272.751    -1.316;
    39.851   272.751    -1.322;
    39.882   272.751    -1.324;
    39.913   272.751    -1.324;
    39.944   272.751    -1.320;
    39.975   272.751    -1.314;
    40.006   272.751    -1.304;
    40.036   272.751    -1.291;
    40.067   272.751    -1.273;
    40.098   272.751    -1.251;
    40.129   272.751    -1.223;
    40.160   272.752    -1.186;
    40.176   272.752    -1.163;
    40.191   272.752    -1.133;
    40.206   272.752    -1.095;
    40.217   272.752    -1.051;
    40.222   272.752    -0.994];

% Modify as necessary
% All x-values are relative to the trailing edge
[m,i] = max(NGV(:,1));
x = NGV(:,1)-m;
x = x-14.37;    % Offset from leading edge of rotor

% Set to streamline value
r = sqrt(NGV(:,2).^2+NGV(:,3).^2);
theta = atan2(NGV(:,3),NGV(:,2));
s = r.*theta;

NGV = [-x -(s-s(i))+20];

% ------------------------------ end of NGV ---------------------------------------------------------
% HPB subroutine
function HPB = HPB_Profile
HPB = [75.902   276.754    19.313;
    75.899   276.757    19.266;
    75.891   276.759    19.228;
    75.880   276.760    19.194;
    75.868   276.760    19.167;
    75.857   276.760    19.138;
    75.835   276.761    19.076;
    75.813   276.763    19.011;
    75.790   276.764    18.944;
    75.768   276.766    18.876;
    75.746   276.767    18.807;
    75.723   276.768    18.740;
    75.701   276.770    18.675;
    75.679   276.771    18.610;
    75.455   276.782    17.966;
    75.232   276.791    17.320;
    75.009   276.799    16.676;
    74.786   276.805    16.034;
    74.563   276.810    15.393;
    74.339   276.813    14.752;
    74.116   276.814    14.110;
    73.893   276.815    13.467;
    73.670   276.814    12.825;
    73.447   276.811    12.187;
    73.223   276.806    11.556;
    73.000   276.799    10.934;
    72.777   276.791    10.319;
    72.554   276.782     9.711;
    72.330   276.770     9.109;
    72.107   276.758     8.511;
    71.884   276.743     7.920;
    71.661   276.728     7.334;
    71.438   276.711     6.754;
    71.214   276.693     6.181;
    70.991   276.673     5.614;
    70.768   276.652     5.054;
    70.545   276.630     4.500;
    70.321   276.607     3.952;
    70.098   276.582     3.411;
    69.875   276.556     2.877;
    69.652   276.530     2.353;
    69.429   276.502     1.838;
    69.205   276.473     1.333;
    68.982   276.443     0.838;
    68.759   276.413     0.354;
    68.536   276.381    -0.119;
    68.313   276.349    -0.580;
    68.089   276.316    -1.030;
    67.866   276.282    -1.467;
    67.643   276.248    -1.890;
    67.420   276.213    -2.298;
    67.196   276.178    -2.692;
    66.973   276.142    -3.070;
    66.750   276.106    -3.434;
    66.527   276.070    -3.783;
    66.304   276.033    -4.118;
    66.080   275.997    -4.438;
    65.857   275.960    -4.744;
    65.634   275.923    -5.036;
    65.411   275.886    -5.315;
    65.188   275.849    -5.578;
    64.964   275.812    -5.826;
    64.741   275.776    -6.057;
    64.518   275.739    -6.273;
    64.295   275.703    -6.472;
    64.071   275.667    -6.656;
    63.848   275.631    -6.826;
    63.625   275.595    -6.982;
    63.402   275.560    -7.124;
    63.179   275.525    -7.255;
    62.955   275.490    -7.374;
    62.732   275.455    -7.481;
    62.509   275.421    -7.577;
    62.286   275.387    -7.662;
    62.062   275.353    -7.736;
    61.839   275.320    -7.798;
    61.616   275.287    -7.850;
    61.393   275.254    -7.889;
    61.170   275.221    -7.917;
    60.946   275.189    -7.932;
    60.723   275.157    -7.935;
    60.500   275.126    -7.927;
    60.277   275.095    -7.907;
    60.054   275.064    -7.875;
    59.830   275.033    -7.832;
    59.607   275.003    -7.777;
    59.384   274.973    -7.710;
    59.161   274.944    -7.629;
    58.937   274.915    -7.535;
    58.714   274.886    -7.426;
    58.491   274.858    -7.301;
    58.268   274.830    -7.158;
    58.045   274.802    -7.001;
    57.821   274.774    -6.835;
    57.598   274.747    -6.660;
    57.375   274.720    -6.471;
    57.152   274.693    -6.265;
    56.929   274.666    -6.042;
    56.705   274.639    -5.805;
    56.482   274.613    -5.556;
    56.259   274.586    -5.299;
    56.036   274.560    -5.031;
    55.812   274.533    -4.753;
    55.589   274.506    -4.463;
    55.366   274.479    -4.157;
    55.143   274.452    -3.834;
    54.920   274.425    -3.490;
    54.696   274.398    -3.121;
    54.473   274.370    -2.727;
    54.250   274.342    -2.309;
    54.027   274.314    -1.868;
    53.803   274.285    -1.410;
    53.781   274.282    -1.363;
    53.759   274.279    -1.317;
    53.737   274.276    -1.270;
    53.714   274.273    -1.223;
    53.692   274.270    -1.176;
    53.670   274.267    -1.128;
    53.647   274.264    -1.079;
    53.625   274.261    -1.019;
    53.614   274.260    -0.983;
    53.603   274.258    -0.940;
    53.591   274.257    -0.883;
    53.584   274.256    -0.820;
    53.580   274.256    -0.743;
    53.584   274.257    -0.659;
    53.591   274.258    -0.608;
    53.603   274.259    -0.544;
    53.614   274.261    -0.502;
    53.625   274.263    -0.466;
    53.647   274.266    -0.405;
    53.670   274.269    -0.356;
    53.692   274.273    -0.313;
    53.714   274.276    -0.275;
    53.737   274.279    -0.241;
    53.759   274.282    -0.210;
    53.781   274.285    -0.182;
    53.803   274.289    -0.156;
    53.826   274.292    -0.132;
    53.848   274.295    -0.109;
    53.870   274.298    -0.088;
    53.893   274.301    -0.069;
    53.915   274.304    -0.050;
    53.937   274.308    -0.033;
    53.960   274.311    -0.017;
    53.982   274.314    -0.002;
    54.004   274.317     0.012;
    54.027   274.320     0.025;
    54.049   274.323     0.037;
    54.071   274.327     0.049;
    54.094   274.330     0.059;
    54.116   274.333     0.069;
    54.138   274.336     0.078;
    54.161   274.339     0.086;
    54.183   274.342     0.094;
    54.205   274.346     0.101;
    54.228   274.349     0.108;
    54.250   274.352     0.113;
    54.272   274.355     0.118;
    54.295   274.358     0.123;
    54.317   274.361     0.127;
    54.339   274.365     0.130;
    54.362   274.368     0.133;
    54.384   274.371     0.135;
    54.406   274.374     0.136;
    54.429   274.377     0.137;
    54.451   274.380     0.137;
    54.473   274.384     0.137;
    54.495   274.387     0.136;
    54.518   274.390     0.135;
    54.540   274.393     0.133;
    54.562   274.396     0.130;
    54.585   274.400     0.127;
    54.607   274.403     0.123;
    54.629   274.406     0.119;
    54.652   274.409     0.114;
    54.674   274.412     0.108;
    54.696   274.415     0.101;
    54.920   274.447    -0.003;
    55.143   274.479    -0.153;
    55.366   274.510    -0.295;
    55.589   274.542    -0.424;
    55.812   274.573    -0.543;
    56.036   274.605    -0.652;
    56.259   274.636    -0.753;
    56.482   274.668    -0.844;
    56.705   274.699    -0.928;
    56.929   274.731    -1.003;
    57.152   274.762    -1.071;
    57.375   274.794    -1.132;
    57.598   274.825    -1.186;
    57.821   274.857    -1.233;
    58.045   274.888    -1.273;
    58.268   274.920    -1.306;
    58.491   274.951    -1.333;
    58.714   274.983    -1.353;
    58.937   275.014    -1.366;
    59.161   275.046    -1.371;
    59.384   275.078    -1.370;
    59.607   275.110    -1.361;
    59.830   275.141    -1.345;
    60.054   275.173    -1.320;
    60.277   275.205    -1.288;
    60.500   275.237    -1.247;
    60.723   275.269    -1.197;
    60.946   275.301    -1.139;
    61.170   275.333    -1.073;
    61.393   275.365    -0.998;
    61.616   275.397    -0.915;
    61.839   275.429    -0.823;
    62.062   275.461    -0.724;
    62.286   275.493    -0.616;
    62.509   275.525    -0.500;
    62.732   275.557    -0.375;
    62.955   275.589    -0.243;
    63.179   275.620    -0.103;
    63.402   275.652     0.046;
    63.625   275.684     0.202;
    63.848   275.715     0.366;
    64.071   275.747     0.538;
    64.295   275.778     0.717;
    64.518   275.809     0.904;
    64.741   275.840     1.099;
    64.964   275.871     1.301;
    65.188   275.902     1.510;
    65.411   275.932     1.726;
    65.634   275.962     1.950;
    65.857   275.992     2.183;
    66.080   276.022     2.423;
    66.304   276.051     2.672;
    66.527   276.080     2.930;
    66.750   276.109     3.197;
    66.973   276.137     3.472;
    67.196   276.165     3.757;
    67.420   276.193     4.050;
    67.643   276.220     4.353;
    67.866   276.247     4.665;
    68.089   276.273     4.987;
    68.313   276.298     5.317;
    68.536   276.323     5.656;
    68.759   276.348     6.004;
    68.982   276.371     6.360;
    69.205   276.394     6.726;
    69.429   276.417     7.100;
    69.652   276.438     7.484;
    69.875   276.459     7.875;
    70.098   276.479     8.276;
    70.321   276.498     8.684;
    70.545   276.517     9.101;
    70.768   276.534     9.525;
    70.991   276.551     9.957;
    71.214   276.566    10.396;
    71.438   276.581    10.843;
    71.661   276.594    11.300;
    71.884   276.607    11.768;
    72.107   276.617    12.248;
    72.330   276.627    12.741;
    72.554   276.635    13.246;
    72.777   276.642    13.757;
    73.000   276.647    14.273;
    73.223   276.652    14.789;
    73.447   276.656    15.303;
    73.670   276.659    15.814;
    73.893   276.661    16.323;
    74.116   276.662    16.829;
    74.339   276.663    17.333;
    74.563   276.663    17.833;
    74.786   276.662    18.331;
    75.009   276.661    18.826;
    75.232   276.659    19.318;
    75.255   276.658    19.367;
    75.277   276.658    19.416;
    75.299   276.658    19.463;
    75.322   276.659    19.498;
    75.344   276.660    19.526;
    75.366   276.662    19.548;
    75.388   276.664    19.567;
    75.411   276.666    19.582;
    75.433   276.668    19.595;
    75.455   276.670    19.606;
    75.478   276.673    19.615;
    75.500   276.676    19.622;
    75.522   276.678    19.627;
    75.545   276.681    19.631;
    75.567   276.684    19.633;
    75.589   276.687    19.633;
    75.612   276.691    19.632;
    75.634   276.694    19.629;
    75.656   276.698    19.625;
    75.679   276.701    19.619;
    75.701   276.705    19.611;
    75.723   276.709    19.601;
    75.746   276.713    19.589;
    75.768   276.717    19.574;
    75.790   276.721    19.557;
    75.813   276.726    19.536;
    75.835   276.731    19.510;
    75.857   276.737    19.477;
    75.868   276.740    19.456;
    75.880   276.743    19.431;
    75.891   276.747    19.397;
    75.899   276.750    19.363;
    75.902   276.754    19.313];

% Modify as necessary
% All x-values are relative to the leading edge
[m,i] = min(HPB(:,1));
x = HPB(:,1)-m;

% Set to streamline value
r = sqrt(HPB(:,2).^2+HPB(:,3).^2);
theta = atan2(HPB(:,3),HPB(:,2));
s = r.*theta;

HPB = [-x -(s-s(i))];